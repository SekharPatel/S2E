{% extends "base.html" %}

{% block title %}Home - My Scans{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
{% endblock %}

{% block sidebar %}
    <!-- The sidebar content is now rendered dynamically by base.js -->
{% endblock %}

{% block content %}
<div class="main-pane-header">
    <h1>{{ data.active_project.name if data.active_project else "All Projects" }}</h1>
    <div class="search-sort">
        <input type="search" id="project-search" placeholder="Search projects..." />
    </div>
</div>

<div class="project-grid-header">
    <div>Project Name</div>
    <div>Targets</div>
    <div>Tasks</div>
    <div>Last Scan</div>
    <div>Actions</div>
</div>

<div class="project-grid" id="project-grid">
    {% for project in data.all_projects %}
    <div class="project-row" data-project-name="{{ project.name | lower }}" data-project-id="{{ project.id }}">
        <div>{{ project.name }}</div>
        <div>{{ project.targets.count() }}</div>
        <div>{{ project.tasks.count() }}</div>
        <div>N/A</div>
        <div class="project-actions">
            <button class="run-btn" title="Run Default Playbook"><i class="fas fa-play"></i></button>
            <button class="delete-btn" title="Delete Project"><i class="fas fa-trash"></i></button>
        </div>
    </div>
    {% else %}
        <p style="padding: 20px;">No projects found. Create one to get started!</p>
    {% endfor %}
</div>

<button class="fab" id="new-project-fab-main">+</button>

{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/home.js') }}"></script>
{% endblock %}
